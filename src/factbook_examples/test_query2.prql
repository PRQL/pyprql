#SELECT f.name       country,
#       c.urban_pop,
#       f.population total_pop
#FROM facts f
#         INNER JOIN (
#    SELECT facts_id,
#           SUM(population) urban_pop
#    FROM cities
#    GROUP BY 1
#) c ON c.facts_id = f.id
#ORDER BY urban_pop DESC
#LIMIT 10;

from cities
join facts [facts_id = id]
select [cities.name, cities.population]
aggregate by [facts.code] [
    urban_pop: "SUM(cities.population)",
    total_pop: "SUM(facts.population)"
]
sort urban_pop DESC
take 25